# Test hjk kill command for terminating sessions
# This test requires a container runtime

# Create a test git repository with unique name
exec git init testrepo-kill
cd testrepo-kill
exec git config user.email 'test@example.com'
exec git config user.name 'Test User'
exec git commit --allow-empty -m 'initial commit'
exec git branch test/kill-session

# Create an instance first
exec hjk run test/kill-session
stdout 'Instance .* ready'
! stderr .

# Wait for container to be running
wait_running test/kill-session

# Create a named session using exec
exec hjk exec test/kill-session -d --name my-session
stdout 'Created'
! stderr .

# Verify the session exists
exec hjk ps test/kill-session
stdout 'my-session'
stdout 'shell'
! stderr .

# Kill the session
exec hjk kill test/kill-session/my-session
stdout 'Killed session my-session'
! stderr .

# Verify session is gone (should show no sessions)
exec hjk ps test/kill-session
stdout 'No sessions found'
! stderr .

# Instance should still exist
exec hjk ps
stdout 'test/kill-session'
! stderr .

# Clean up
exec hjk rm test/kill-session --force
stdout 'Removed'
! stderr .
